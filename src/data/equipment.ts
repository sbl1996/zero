import type { Equipment, EquipSlotKey, EquipmentTemplate } from '@/types/domain'

export const BASE_EQUIPMENT_TEMPLATES: EquipmentTemplate[] = [
  // 一级装备
  {
    id: 'iron-sword',
    name: '铁剑',
    slot: 'weaponR',
    requiredRealmTier: 1,
    baseMain: { ATK: 15 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'iron-maul',
    name: '铁锤',
    slot: 'weapon2H',
    requiredRealmTier: 1,
    baseMain: { ATK: 25 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'iron-shield',
    name: '铁盾',
    slot: 'shieldL',
    requiredRealmTier: 1,
    baseMain: { DEF: 10 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'iron-plate',
    name: '铁甲',
    slot: 'armor',
    requiredRealmTier: 1,
    baseMain: { DEF: 15 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'iron-helm',
    name: '铁盔',
    slot: 'helmet',
    requiredRealmTier: 1,
    baseMain: { DEF: 8 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'iron-ring',
    name: '铁戒指',
    slot: 'ring',
    requiredRealmTier: 1,
    baseMain: { HP: 30 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },

  // 二级装备
  {
    id: 'steel-blade',
    name: '钢刃',
    slot: 'weaponR',
    requiredRealmTier: 2,
    baseMain: { ATK: 40 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'steel-greatsword',
    name: '巨型钢剑',
    slot: 'weapon2H',
    requiredRealmTier: 2,
    baseMain: { ATK: 72 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'steel-bulwark',
    name: '钢盾',
    slot: 'shieldL',
    requiredRealmTier: 2,
    baseMain: { DEF: 16 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'steel-cuirass',
    name: '钢甲',
    slot: 'armor',
    requiredRealmTier: 2,
    baseMain: { DEF: 24 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'steel-helm',
    name: '钢盔',
    slot: 'helmet',
    requiredRealmTier: 2,
    baseMain: { DEF: 13 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'amber-ring',
    name: '琥珀戒',
    slot: 'ring',
    requiredRealmTier: 2,
    baseMain: { HP: 48 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },

  // 三级装备
  {
    id: 'knight-blade',
    name: '骑士刃',
    slot: 'weaponR',
    requiredRealmTier: 3,
    baseMain: { ATK: 55 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'knight-warhammer',
    name: '骑士战锤',
    slot: 'weapon2H',
    requiredRealmTier: 3,
    baseMain: { ATK: 99 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'knight-tower-shield',
    name: '骑士塔盾',
    slot: 'shieldL',
    requiredRealmTier: 3,
    baseMain: { DEF: 22 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'knight-armor',
    name: '骑士甲',
    slot: 'armor',
    requiredRealmTier: 3,
    baseMain: { DEF: 33 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'knight-helm',
    name: '骑士盔',
    slot: 'helmet',
    requiredRealmTier: 3,
    baseMain: { DEF: 18 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'ruby-ring',
    name: '红玉戒',
    slot: 'ring',
    requiredRealmTier: 3,
    baseMain: { HP: 66 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },

  // 四级装备
  {
    id: 'mithril-saber',
    name: '秘银军刀',
    slot: 'weaponR',
    requiredRealmTier: 4,
    baseMain: { ATK: 78 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'mithril-claymore',
    name: '秘银巨剑',
    slot: 'weapon2H',
    requiredRealmTier: 4,
    baseMain: { ATK: 140 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'mithril-aegis',
    name: '秘银盾',
    slot: 'shieldL',
    requiredRealmTier: 4,
    baseMain: { DEF: 31 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'mithril-hauberk',
    name: '秘银甲',
    slot: 'armor',
    requiredRealmTier: 4,
    baseMain: { DEF: 46 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'mithril-coif',
    name: '秘银盔',
    slot: 'helmet',
    requiredRealmTier: 4,
    baseMain: { DEF: 25 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'sapphire-ring',
    name: '蓝宝石戒',
    slot: 'ring',
    requiredRealmTier: 4,
    baseMain: { HP: 93 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },

  // 五级装备
  {
    id: 'runed-edge',
    name: '符文之锋',
    slot: 'weaponR',
    requiredRealmTier: 5,
    baseMain: { ATK: 105 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'runed-greataxe',
    name: '符文巨斧',
    slot: 'weapon2H',
    requiredRealmTier: 5,
    baseMain: { ATK: 189 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'runed-bulwark',
    name: '符文壁垒',
    slot: 'shieldL',
    requiredRealmTier: 5,
    baseMain: { DEF: 42 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'runed-cuirass',
    name: '符文甲',
    slot: 'armor',
    requiredRealmTier: 5,
    baseMain: { DEF: 63 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'runed-helm',
    name: '符文头盔',
    slot: 'helmet',
    requiredRealmTier: 5,
    baseMain: { DEF: 34 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'topaz-ring',
    name: '黄玉戒',
    slot: 'ring',
    requiredRealmTier: 5,
    baseMain: { HP: 126 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },

  // 六级装备
  {
    id: 'dragonbone-fang',
    name: '龙骨之牙',
    slot: 'weaponR',
    requiredRealmTier: 6,
    baseMain: { ATK: 130 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'dragonslayer',
    name: '屠龙者',
    slot: 'weapon2H',
    requiredRealmTier: 6,
    baseMain: { ATK: 234 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'dragonbone-shield',
    name: '龙骨盾',
    slot: 'shieldL',
    requiredRealmTier: 6,
    baseMain: { DEF: 52 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'dragonscale-armor',
    name: '龙鳞甲',
    slot: 'armor',
    requiredRealmTier: 6,
    baseMain: { DEF: 78 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'dragonbone-helm',
    name: '龙骨盔',
    slot: 'helmet',
    requiredRealmTier: 6,
    baseMain: { DEF: 42 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'emerald-ring',
    name: '祖母绿戒',
    slot: 'ring',
    requiredRealmTier: 6,
    baseMain: { HP: 156 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },

  // 六级装备
  {
    id: 'radiant-sword',
    name: '辟光剑',
    slot: 'weaponR',
    requiredRealmTier: 7,
    baseMain: { ATK: 160 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'starbreaker',
    name: '碎星者',
    slot: 'weapon2H',
    requiredRealmTier: 7,
    baseMain: { ATK: 288 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'celestial-bulwark',
    name: '天穹壁垒',
    slot: 'shieldL',
    requiredRealmTier: 7,
    baseMain: { DEF: 64 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'starlit-plate',
    name: '星辉甲',
    slot: 'armor',
    requiredRealmTier: 7,
    baseMain: { DEF: 96 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'starcrest',
    name: '星冕',
    slot: 'helmet',
    requiredRealmTier: 7,
    baseMain: { DEF: 51 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'morningstar-ring',
    name: '晨星戒',
    slot: 'ring',
    requiredRealmTier: 7,
    baseMain: { HP: 192 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
]

export const STARTING_EQUIPMENT_IDS: Partial<Record<EquipSlotKey, string>> = {
}

export function getStartingEquipment(): Partial<Record<EquipSlotKey, Equipment>> {
  const result: Partial<Record<EquipSlotKey, Equipment>> = {}

  for (const [slot, templateId] of Object.entries(STARTING_EQUIPMENT_IDS)) {
    const template = BASE_EQUIPMENT_TEMPLATES.find(t => t.id === templateId)
    if (template) {
      const equipment: Equipment = {
        id: template.id,
        name: template.name,
        slot: template.slot,
        level: 1,
        mainStat: { ...template.baseMain },
        subs: { ...template.baseSubs },
        flatCapMultiplier: template.flatCapMultiplier,
        requiredRealmTier: template.requiredRealmTier,
        exclusive: template.exclusive,
      }
      result[slot as EquipSlotKey] = equipment
    }
  }

  return result
}

export const EQUIPMENT_PRICES = {
  'iron-sword': 300,
  'iron-maul': 500,
  'iron-shield': 250,
  'iron-plate': 400,
  'iron-helm': 200,
  'iron-ring': 220,
  'steel-blade': 600,
  'steel-greatsword': 1000,
  'steel-bulwark': 500,
  'steel-cuirass': 800,
  'steel-helm': 400,
  'amber-ring': 440,
  'knight-blade': 1050,
  'knight-warhammer': 1750,
  'knight-tower-shield': 875,
  'knight-armor': 1400,
  'knight-helm': 700,
  'ruby-ring': 770,
  'mithril-saber': 1800,
  'mithril-claymore': 3000,
  'mithril-aegis': 1500,
  'mithril-hauberk': 2400,
  'mithril-coif': 1200,
  'sapphire-ring': 1320,
  'runed-edge': 2700,
  'runed-greataxe': 4500,
  'runed-bulwark': 2250,
  'runed-cuirass': 3600,
  'runed-helm': 1800,
  'topaz-ring': 1980,
  'dragonbone-fang': 3900,
  'dragonslayer': 6500,
  'dragonbone-shield': 3250,
  'dragonscale-armor': 5200,
  'dragonbone-helm': 2600,
  'emerald-ring': 2860,
  'radiant-sword': 5400,
  'starbreaker': 9000,
  'celestial-bulwark': 4500,
  'starlit-plate': 7200,
  'starcrest': 3600,
  'morningstar-ring': 3960,
} as const
