import type { Equipment, EquipSlot, EquipmentTemplate } from '@/types/domain'

export const BASE_EQUIPMENT_TEMPLATES: EquipmentTemplate[] = [
  // Level 1 装备
  {
    id: 'iron-sword',
    name: '铁剑',
    slot: 'weaponR',
    requiredLevel: 1,
    baseMain: { ATK: 25 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'iron-maul',
    name: '铁锤',
    slot: 'weapon2H',
    requiredLevel: 1,
    baseMain: { ATK: 45 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'iron-shield',
    name: '铁盾',
    slot: 'shieldL',
    requiredLevel: 1,
    baseMain: { DEF: 10 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'iron-plate',
    name: '铁甲',
    slot: 'armor',
    requiredLevel: 1,
    baseMain: { DEF: 15 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'iron-helm',
    name: '铁盔',
    slot: 'helmet',
    requiredLevel: 1,
    baseMain: { DEF: 8 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'iron-gloves',
    name: '铁手套',
    slot: 'gloves',
    requiredLevel: 1,
    baseMain: { DEF: 5 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'leather-belt',
    name: '皮带',
    slot: 'belt',
    requiredLevel: 1,
    baseMain: { DEF: 6 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'iron-ring',
    name: '铁戒指',
    slot: 'ring',
    requiredLevel: 1,
    baseMain: { HP: 30 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'iron-boots',
    name: '铁靴',
    slot: 'boots',
    requiredLevel: 1,
    baseMain: { DEF: 7 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },

  // Level 10 装备
  {
    id: 'steel-blade',
    name: '钢刃',
    slot: 'weaponR',
    requiredLevel: 10,
    baseMain: { ATK: 40 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'steel-greatsword',
    name: '巨型钢剑',
    slot: 'weapon2H',
    requiredLevel: 10,
    baseMain: { ATK: 72 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'steel-bulwark',
    name: '钢盾',
    slot: 'shieldL',
    requiredLevel: 10,
    baseMain: { DEF: 16 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'steel-cuirass',
    name: '钢甲',
    slot: 'armor',
    requiredLevel: 10,
    baseMain: { DEF: 24 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'steel-helm',
    name: '钢盔',
    slot: 'helmet',
    requiredLevel: 10,
    baseMain: { DEF: 13 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'steel-gauntlets',
    name: '钢护手',
    slot: 'gloves',
    requiredLevel: 10,
    baseMain: { DEF: 8 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'studded-belt',
    name: '铆钉腰带',
    slot: 'belt',
    requiredLevel: 10,
    baseMain: { DEF: 10 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'amber-ring',
    name: '琥珀戒',
    slot: 'ring',
    requiredLevel: 10,
    baseMain: { HP: 48 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'steel-greaves',
    name: '钢靴',
    slot: 'boots',
    requiredLevel: 10,
    baseMain: { DEF: 11 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },

  // Level 20 装备
  {
    id: 'knight-blade',
    name: '骑士刃',
    slot: 'weaponR',
    requiredLevel: 20,
    baseMain: { ATK: 55 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'knight-warhammer',
    name: '骑士战锤',
    slot: 'weapon2H',
    requiredLevel: 20,
    baseMain: { ATK: 99 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'knight-tower-shield',
    name: '骑士塔盾',
    slot: 'shieldL',
    requiredLevel: 20,
    baseMain: { DEF: 22 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'knight-armor',
    name: '骑士甲',
    slot: 'armor',
    requiredLevel: 20,
    baseMain: { DEF: 33 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'knight-helm',
    name: '骑士盔',
    slot: 'helmet',
    requiredLevel: 20,
    baseMain: { DEF: 18 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'knight-gauntlets',
    name: '骑士护手',
    slot: 'gloves',
    requiredLevel: 20,
    baseMain: { DEF: 11 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'reinforced-belt',
    name: '加固腰带',
    slot: 'belt',
    requiredLevel: 20,
    baseMain: { DEF: 13 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'ruby-ring',
    name: '红玉戒',
    slot: 'ring',
    requiredLevel: 20,
    baseMain: { HP: 66 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'knight-sabatons',
    name: '骑士胫甲',
    slot: 'boots',
    requiredLevel: 20,
    baseMain: { DEF: 15 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },

  // Level 30 装备
  {
    id: 'mithril-saber',
    name: '秘银军刀',
    slot: 'weaponR',
    requiredLevel: 30,
    baseMain: { ATK: 78 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'mithril-claymore',
    name: '秘银巨剑',
    slot: 'weapon2H',
    requiredLevel: 30,
    baseMain: { ATK: 140 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'mithril-aegis',
    name: '秘银盾',
    slot: 'shieldL',
    requiredLevel: 30,
    baseMain: { DEF: 31 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'mithril-hauberk',
    name: '秘银甲',
    slot: 'armor',
    requiredLevel: 30,
    baseMain: { DEF: 46 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'mithril-coif',
    name: '秘银盔',
    slot: 'helmet',
    requiredLevel: 30,
    baseMain: { DEF: 25 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'mithril-gloves',
    name: '秘银护手',
    slot: 'gloves',
    requiredLevel: 30,
    baseMain: { DEF: 16 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'silverweave-belt',
    name: '银纹腰带',
    slot: 'belt',
    requiredLevel: 30,
    baseMain: { DEF: 19 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'sapphire-ring',
    name: '蓝宝石戒',
    slot: 'ring',
    requiredLevel: 30,
    baseMain: { HP: 93 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'mithril-boots',
    name: '秘银长靴',
    slot: 'boots',
    requiredLevel: 30,
    baseMain: { DEF: 22 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },

  // Level 40 装备
  {
    id: 'runed-edge',
    name: '符文之锋',
    slot: 'weaponR',
    requiredLevel: 40,
    baseMain: { ATK: 105 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'runed-greataxe',
    name: '符文巨斧',
    slot: 'weapon2H',
    requiredLevel: 40,
    baseMain: { ATK: 189 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'runed-bulwark',
    name: '符文壁垒',
    slot: 'shieldL',
    requiredLevel: 40,
    baseMain: { DEF: 42 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'runed-cuirass',
    name: '符文甲',
    slot: 'armor',
    requiredLevel: 40,
    baseMain: { DEF: 63 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'runed-helm',
    name: '符文头盔',
    slot: 'helmet',
    requiredLevel: 40,
    baseMain: { DEF: 34 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'runed-gauntlets',
    name: '符文护手',
    slot: 'gloves',
    requiredLevel: 40,
    baseMain: { DEF: 21 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'glyph-belt',
    name: '符纹腰带',
    slot: 'belt',
    requiredLevel: 40,
    baseMain: { DEF: 25 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'topaz-ring',
    name: '黄玉戒',
    slot: 'ring',
    requiredLevel: 40,
    baseMain: { HP: 126 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'runed-greaves',
    name: '符文胫甲',
    slot: 'boots',
    requiredLevel: 40,
    baseMain: { DEF: 29 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },

  // Level 50 装备
  {
    id: 'dragonbone-fang',
    name: '龙骨之牙',
    slot: 'weaponR',
    requiredLevel: 50,
    baseMain: { ATK: 130 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'dragonslayer',
    name: '屠龙者',
    slot: 'weapon2H',
    requiredLevel: 50,
    baseMain: { ATK: 234 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'dragonbone-shield',
    name: '龙骨盾',
    slot: 'shieldL',
    requiredLevel: 50,
    baseMain: { DEF: 52 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'dragonscale-armor',
    name: '龙鳞甲',
    slot: 'armor',
    requiredLevel: 50,
    baseMain: { DEF: 78 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'dragonbone-helm',
    name: '龙骨盔',
    slot: 'helmet',
    requiredLevel: 50,
    baseMain: { DEF: 42 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'dragonbone-gauntlets',
    name: '龙骨护手',
    slot: 'gloves',
    requiredLevel: 50,
    baseMain: { DEF: 26 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'dragonscribed-belt',
    name: '龙纹腰带',
    slot: 'belt',
    requiredLevel: 50,
    baseMain: { DEF: 31 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'emerald-ring',
    name: '祖母绿戒',
    slot: 'ring',
    requiredLevel: 50,
    baseMain: { HP: 156 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'dragonscale-boots',
    name: '龙鳞靴',
    slot: 'boots',
    requiredLevel: 50,
    baseMain: { DEF: 36 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },

  // Level 60 装备
  {
    id: 'radiant-sword',
    name: '辟光剑',
    slot: 'weaponR',
    requiredLevel: 60,
    baseMain: { ATK: 160 },
    baseSubs: { addATK: 3 },
    flatCapMultiplier: 0.25,
  },
  {
    id: 'starbreaker',
    name: '碎星者',
    slot: 'weapon2H',
    requiredLevel: 60,
    baseMain: { ATK: 288 },
    baseSubs: { addATK: 4 },
    exclusive: '2H',
    flatCapMultiplier: 0.25,
  },
  {
    id: 'celestial-bulwark',
    name: '天穹壁垒',
    slot: 'shieldL',
    requiredLevel: 60,
    baseMain: { DEF: 64 },
    baseSubs: { addDEF: 2 },
    exclusive: '1H+Shield',
    flatCapMultiplier: 0.18,
  },
  {
    id: 'starlit-plate',
    name: '星辉甲',
    slot: 'armor',
    requiredLevel: 60,
    baseMain: { DEF: 96 },
    baseSubs: { addDEF: 2, addHP: 20 },
    flatCapMultiplier: 0.18,
  },
  {
    id: 'starcrest',
    name: '星冕',
    slot: 'helmet',
    requiredLevel: 60,
    baseMain: { DEF: 51 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'starlit-gauntlets',
    name: '星辉护手',
    slot: 'gloves',
    requiredLevel: 60,
    baseMain: { DEF: 32 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'starwoven-belt',
    name: '星纹腰带',
    slot: 'belt',
    requiredLevel: 60,
    baseMain: { DEF: 38 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'morningstar-ring',
    name: '晨星戒',
    slot: 'ring',
    requiredLevel: 60,
    baseMain: { HP: 192 },
    baseSubs: { addHP: 5 },
    flatCapMultiplier: 0.15,
  },
  {
    id: 'starlit-boots',
    name: '星辉长靴',
    slot: 'boots',
    requiredLevel: 60,
    baseMain: { DEF: 45 },
    baseSubs: { addDEF: 1 },
    flatCapMultiplier: 0.15,
  },
]

export const STARTING_EQUIPMENT_IDS: Partial<Record<EquipSlot, string>> = {
  weaponR: 'iron-sword',
  armor: 'iron-plate',
  helmet: 'iron-helm',
}

export function getStartingEquipment(): Partial<Record<EquipSlot, Equipment>> {
  const result: Partial<Record<EquipSlot, Equipment>> = {}

  for (const [slot, templateId] of Object.entries(STARTING_EQUIPMENT_IDS)) {
    const template = BASE_EQUIPMENT_TEMPLATES.find(t => t.id === templateId)
    if (template) {
      const equipment: Equipment = {
        id: template.id,
        name: template.name,
        slot: template.slot,
        level: 1,
        mainStat: { ...template.baseMain },
        subs: { ...template.baseSubs },
        flatCapMultiplier: template.flatCapMultiplier,
        requiredLevel: template.requiredLevel,
        exclusive: template.exclusive,
      }
      result[slot as EquipSlot] = equipment
    }
  }

  return result
}

export const EQUIPMENT_PRICES = {
  'iron-sword': 300,
  'iron-maul': 500,
  'iron-shield': 250,
  'iron-plate': 400,
  'iron-helm': 200,
  'iron-gloves': 150,
  'leather-belt': 180,
  'iron-ring': 220,
  'iron-boots': 200,
  'steel-blade': 600,
  'steel-greatsword': 1000,
  'steel-bulwark': 500,
  'steel-cuirass': 800,
  'steel-helm': 400,
  'steel-gauntlets': 300,
  'studded-belt': 360,
  'amber-ring': 440,
  'steel-greaves': 400,
  'knight-blade': 1050,
  'knight-warhammer': 1750,
  'knight-tower-shield': 875,
  'knight-armor': 1400,
  'knight-helm': 700,
  'knight-gauntlets': 525,
  'reinforced-belt': 630,
  'ruby-ring': 770,
  'knight-sabatons': 700,
  'mithril-saber': 1800,
  'mithril-claymore': 3000,
  'mithril-aegis': 1500,
  'mithril-hauberk': 2400,
  'mithril-coif': 1200,
  'mithril-gloves': 900,
  'silverweave-belt': 1080,
  'sapphire-ring': 1320,
  'mithril-boots': 1200,
  'runed-edge': 2700,
  'runed-greataxe': 4500,
  'runed-bulwark': 2250,
  'runed-cuirass': 3600,
  'runed-helm': 1800,
  'runed-gauntlets': 1350,
  'glyph-belt': 1620,
  'topaz-ring': 1980,
  'runed-greaves': 1800,
  'dragonbone-fang': 3900,
  'dragonslayer': 6500,
  'dragonbone-shield': 3250,
  'dragonscale-armor': 5200,
  'dragonbone-helm': 2600,
  'dragonbone-gauntlets': 1950,
  'dragonscribed-belt': 2340,
  'emerald-ring': 2860,
  'dragonscale-boots': 2600,
  'radiant-sword': 5400,
  'starbreaker': 9000,
  'celestial-bulwark': 4500,
  'starlit-plate': 7200,
  'starcrest': 3600,
  'starlit-gauntlets': 2700,
  'starwoven-belt': 3240,
  'morningstar-ring': 3960,
  'starlit-boots': 3600,
} as const
